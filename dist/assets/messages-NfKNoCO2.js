import{r as x,k as N,j as e,m as p,l as v,g as u,c as d,B as y,n as L,X as E,p as b,u as T,o as C,q as F,A as I,P as B}from"./index-DHVO_Rqi.js";import{P as R}from"./page-layout-UcvAjhJs.js";import{C as q}from"./comment-card-D-l797Tm.js";import{P as K}from"./pagination-BICAacLT.js";import{u as V}from"./useQuery-ShPTI-yv.js";const W=({setActive:t})=>{const[s,i]=x.useState(""),o=N().setMode,[m,c]=x.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(p.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed z-[100] top-0 left-0 w-full h-screen py-8  bg-[#EFDEBE] overflow-hidden",children:[e.jsx("img",{src:"/images/texture047.png",className:"size-full absolute top-0 left-0 pointer-events-none  object-cover mix-blend-multiply opacity-50"}),e.jsxs("div",{className:"container",children:[e.jsxs("button",{onClick:()=>t(!1),className:"flex items-center gap-1 h-10 mb-8",children:[e.jsx("img",{src:"/images/arrow.svg"}),e.jsx("h6",{className:"text-16 !font-normal text-ON_SURFACE_VAR",children:"Wernutsýa nazad"})]}),e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx("h5",{className:"font-semibold",children:"Ostaw swoý kommentariý"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"text-16 text-left",children:"Kommentariý"}),e.jsx(v,{value:s,onChange:l=>{i(l.target.value)},className:"p-4",rows:14,maxLength:500,minLength:10}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h5",{className:"text-error"}),e.jsxs("div",{className:"text-right text-14 !font-normal justify-end",children:[s.length,"/500"]})]})]}),e.jsx(u,{onClick:()=>{s.length>10&&c(!0)&&o("tost")},children:"Otprawit"})]})]})]}),m&&e.jsx(p.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{ease:"easeInOut"},className:d("fixed top-0 left-0 right-0 bottom-0 z-[100] overflow-hidden bg-[#7A590C]/[16%] w-full h-screen"),children:e.jsxs(p.div,{className:d("absolute py-8 w-[328px] h-[168px] px-4 top-1/2 -translate-x-1/2 left-1/2 -translate-y-1/2 shadow-bottom"),children:[e.jsx(y,{className:d("bg-[url('/images/tost-mob-shape.svg')] tost-mob-path")}),e.jsxs("div",{className:"flex flex-col md:gap-4 gap-2 text-center",children:[e.jsx("h5",{className:"font-semibold md:text-[24px] text-[20px]",children:"Waş kommentariý otprawlen"}),e.jsx("h6",{className:"md:text-16 text-[14px] leading-[145%] -tracking-wide",children:"Wy uwidite swoý kommentriý posle moderasii"}),e.jsx(u,{onClick:()=>{c(!1),t(!1)},className:"text-[14px]",children:"Zakryt"})]})]})})]})},r=L(t=>({userComments:JSON.parse(sessionStorage.getItem("userComments")||"[]"),commentSucces:!1,commentOpen:!1,setCommentOpen:s=>t(()=>({commentOpen:s})),setCommentSuccess:s=>t(()=>({commentSucces:s})),setComments:s=>{sessionStorage.setItem("userComments",JSON.stringify(s)),t({userComments:s})},clearComments:()=>{sessionStorage.removeItem("userComments"),t({userComments:[]})}})),_=()=>{const t=x.useRef(null),[s,i]=x.useState(""),o=r().setCommentOpen,m=r().setCommentSuccess,c=async()=>{try{await b.postComment({comment_text:s}),m(!0),o(!1)}catch(l){console.error(l)}};return e.jsx(p.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{ease:"easeInOut"},className:d("fixed top-0 left-0 right-0 bottom-0 z-[100] overflow-hidden bg-[#7A590C]/[16%] w-full h-screen"),children:e.jsxs("div",{ref:t,className:d("absolute md:py-[52px] py-8 w-[328px] h-[532px] md:w-[408px] md:px-6 px-4 top-1/2 -translate-x-1/2 left-1/2 -translate-y-1/2 shadow-bottom"),children:[e.jsx(y,{className:"bg-[url('/images/messages/comment-modal-shape.svg')] comment-modal-path"}),e.jsxs("div",{className:"flex md:bg-none bg-[url('/images/texture047.png')] bg-cover md:size-auto h-screen flex-col gap-6 text-center",children:[e.jsx(E,{onClick:()=>o(!1),className:"absolute md:block hidden top-3 right-3 p-1 cursor-pointer",size:30}),e.jsx("h5",{className:"font-semibold",children:"Ostaw swoý kommentariý"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"text-16 text-left",children:"Kommentariý"}),e.jsx(v,{value:s,onChange:l=>{i(l.target.value)},className:"p-4",rows:11,maxLength:500,minLength:10}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h5",{className:"text-error"}),e.jsxs("div",{className:"text-right text-14 !font-normal justify-end",children:[s.length,"/500"]})]})]}),e.jsx(u,{onClick:()=>{s.length>10&&c()},children:"Otprawit"})]})]})})},J=()=>{const{data:t,isLoading:s,isError:i,isSuccess:o}=V({queryKey:["comments"],queryFn:()=>b.getComments(),select:m=>m});return{data:t,isLoading:s,isError:i,isSuccess:o}},X=()=>{const[t,s]=x.useState(1),[i,o]=x.useState(!1),m=T("(min-width: 768px)"),c=r(a=>a.commentSucces),l=r().setCommentSuccess,{data:n,isLoading:w}=J(),j=N(a=>a.setMode),S=C(a=>a.setMobActive),k=C(a=>a.setActive),O=r().commentOpen,P=r().setCommentOpen,g=6,z=a=>{s(a)},h=n?n.slice((t-1)*g,t*g):[],f=F(a=>a.accessToken),M=()=>{m&&f?(j("comment"),P(!0)):m&&!f?(k(!0),j("login")):!m&&f?o(!0):S(!0)};return console.log(n),e.jsxs(e.Fragment,{children:[e.jsxs(I,{children:[O&&e.jsx(_,{}),c&&e.jsx(B,{title:"Ваш комментарий отправлен",text:"Ждите пока модераторы займутся вашим комментарием",setActive:l}),i&&e.jsx(W,{setActive:o})]}),e.jsx(R,{loading:w,title:"Teswirler",messagesText:"Hormatly muşdaklar!",text:"Sahypadaky eserler barada seljerlenen teswirlerlerňizi, pikirleňizii hem-de tekliplerňizi aşakda goýup bilersiňiz. Siz bilen gatnaşykda bolar ýaly, elektron adresiňizi goýmany hem unutmaň!",className:"gap-12",children:e.jsxs("div",{className:"",children:[e.jsx("div",{className:"mx-auto w-[892px] flex flex-col gap-6",children:h==null?void 0:h.map((a,A)=>e.jsx(q,{...a},A))}),n&&(n==null?void 0:n.length)>10&&e.jsx(K,{perPage:g,currentPage:t,totalPages:(n==null?void 0:n.length)||0,onChangePage:z,className:"mt-8"}),e.jsx("div",{className:"flex justify-center",children:e.jsx(u,{onClick:M,className:"px-6 mt-16",children:"Ostawit swoý kommentariý"})})]})})]})};export{X as default};
